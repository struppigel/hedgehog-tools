# Ghidra Jython script
# Resolves LummaStealer API hashes calculated with Murmurhash2
# Tested on unpacked sample f33a6585faa522f1f03b4bacbd77cb5adc0d1ad54223b89dc8f6ebb05edfe000
# This is an old Lumma sample from 2022, it is an ideal example for educational purposes in resolving API hashes
# It is also a good example to feature a bit more than just adding comments
#
# The script will do the following:
# * add comments with resolved API hash
# * create an enum named LummaAPIHash
# * create equates for resolved API hashes -- that means the hash values will be represented by the api name instead of the integer
# * create labels for the resolved function variables -- that means subsequent function calls have the resolved API name
#
#@author Karsten Hahn
#@category Modification
#@keybinding 
#@menupath 
#@toolbar 

from ghidra.program.model.scalar import Scalar
from ghidra.program.model.listing import CodeUnit
from ghidra.program.model.data import EnumDataType
from ghidra.program.database.data import EnumDB
from ghidra.program.model.symbol import SourceType
from ghidra.app.cmd.equate import SetEquateCmd
from ghidra.app.cmd.equate import ClearEquateCmd

# These lists were created by hedgehog-tools\Python helper scripts\extract_exports_symbol.py
# kernel32.dll APIs
api_list_kernel32 = ['AcquireSRWLockExclusive','AcquireSRWLockShared','ActivateActCtx','ActivateActCtxWorker','AddAtomA','AddAtomW','AddConsoleAliasA','AddConsoleAliasW','AddDllDirectory','AddIntegrityLabelToBoundaryDescriptor','AddLocalAlternateComputerNameA','AddLocalAlternateComputerNameW','AddRefActCtx','AddRefActCtxWorker','AddResourceAttributeAce','AddSIDToBoundaryDescriptor','AddScopedPolicyIDAce','AddSecureMemoryCacheCallback','AddVectoredContinueHandler','AddVectoredExceptionHandler','AdjustCalendarDate','AllocConsole','AllocateUserPhysicalPages','AllocateUserPhysicalPagesNuma','AppPolicyGetClrCompat','AppPolicyGetCreateFileAccess','AppPolicyGetLifecycleManagement','AppPolicyGetMediaFoundationCodecLoading','AppPolicyGetProcessTerminationMethod','AppPolicyGetShowDeveloperDiagnostic','AppPolicyGetThreadInitializationType','AppPolicyGetWindowingModel','AppXGetOSMaxVersionTested','ApplicationRecoveryFinished','ApplicationRecoveryInProgress','AreFileApisANSI','AssignProcessToJobObject','AttachConsole','BackupRead','BackupSeek','BackupWrite','BaseCheckAppcompatCache','BaseCheckAppcompatCacheEx','BaseCheckAppcompatCacheExWorker','BaseCheckAppcompatCacheWorker','BaseCheckElevation','BaseCleanupAppcompatCacheSupport','BaseCleanupAppcompatCacheSupportWorker','BaseDestroyVDMEnvironment','BaseDllReadWriteIniFile','BaseDumpAppcompatCache','BaseDumpAppcompatCacheWorker','BaseElevationPostProcessing','BaseFlushAppcompatCache','BaseFlushAppcompatCacheWorker','BaseFormatObjectAttributes','BaseFormatTimeOut','BaseFreeAppCompatDataForProcessWorker','BaseGenerateAppCompatData','BaseGetNamedObjectDirectory','BaseInitAppcompatCacheSupport','BaseInitAppcompatCacheSupportWorker','BaseIsAppcompatInfrastructureDisabled','BaseIsAppcompatInfrastructureDisabledWorker','BaseIsDosApplication','BaseQueryModuleData','BaseReadAppCompatDataForProcessWorker','BaseSetLastNTError','BaseThreadInitThunk','BaseUpdateAppcompatCache','BaseUpdateAppcompatCacheWorker','BaseUpdateVDMEntry','BaseVerifyUnicodeString','BaseWriteErrorElevationRequiredEvent','Basep8BitStringToDynamicUnicodeString','BasepAllocateActivationContextActivationBlock','BasepAnsiStringToDynamicUnicodeString','BasepAppContainerEnvironmentExtension','BasepAppXExtension','BasepCheckAppCompat','BasepCheckWebBladeHashes','BasepCheckWinSaferRestrictions','BasepConstructSxsCreateProcessMessage','BasepCopyEncryption','BasepFinishPackageActivationForSxS','BasepFreeActivationContextActivationBlock','BasepFreeAppCompatData','BasepGetAppCompatData','BasepGetComputerNameFromNtPath','BasepGetExeArchType','BasepGetPackageActivationTokenForSxS','BasepInitAppCompatData','BasepIsProcessAllowed','BasepMapModuleHandle','BasepNotifyLoadStringResource','BasepPostSuccessAppXExtension','BasepProcessInvalidImage','BasepQueryAppCompat','BasepQueryModuleChpeSettings','BasepReleaseAppXContext','BasepReleaseSxsCreateProcessUtilityStruct','BasepReportFault','BasepSetFileEncryptionCompression','Beep','BeginUpdateResourceA','BeginUpdateResourceW','BindIoCompletionCallback','BuildCommDCBA','BuildCommDCBAndTimeoutsA','BuildCommDCBAndTimeoutsW','BuildCommDCBW','CallNamedPipeA','CallNamedPipeW','CallbackMayRunLong','CancelDeviceWakeupRequest','CancelIo','CancelIoEx','CancelSynchronousIo','CancelThreadpoolIo','CancelTimerQueueTimer','CancelWaitableTimer','CeipIsOptedIn','ChangeTimerQueueTimer','CheckAllowDecryptedRemoteDestinationPolicy','CheckElevation','CheckElevationEnabled','CheckForReadOnlyResource','CheckForReadOnlyResourceFilter','CheckIsMSIXPackage','CheckNameLegalDOS8Dot3A','CheckNameLegalDOS8Dot3W','CheckRemoteDebuggerPresent','CheckTokenCapability','CheckTokenMembershipEx','ClearCommBreak','ClearCommError','CloseConsoleHandle','CloseHandle','ClosePackageInfo','ClosePrivateNamespace','CloseProfileUserMapping','ClosePseudoConsole','CloseState','CloseThreadpool','CloseThreadpoolCleanupGroup','CloseThreadpoolCleanupGroupMembers','CloseThreadpoolIo','CloseThreadpoolTimer','CloseThreadpoolWait','CloseThreadpoolWork','CmdBatNotification','CommConfigDialogA','CommConfigDialogW','CompareCalendarDates','CompareFileTime','CompareStringA','CompareStringEx','CompareStringOrdinal','CompareStringW','ConnectNamedPipe','ConsoleMenuControl','ContinueDebugEvent','ConvertCalDateTimeToSystemTime','ConvertDefaultLocale','ConvertFiberToThread','ConvertNLSDayOfWeekToWin32DayOfWeek','ConvertSystemTimeToCalDateTime','ConvertThreadToFiber','ConvertThreadToFiberEx','CopyContext','CopyFile2','CopyFileA','CopyFileExA','CopyFileExW','CopyFileTransactedA','CopyFileTransactedW','CopyFileW','CopyLZFile','CreateActCtxA','CreateActCtxW','CreateActCtxWWorker','CreateBoundaryDescriptorA','CreateBoundaryDescriptorW','CreateConsoleScreenBuffer','CreateDirectoryA','CreateDirectoryExA','CreateDirectoryExW','CreateDirectoryTransactedA','CreateDirectoryTransactedW','CreateDirectoryW','CreateEnclave','CreateEventA','CreateEventExA','CreateEventExW','CreateEventW','CreateFiber','CreateFiberEx','CreateFile2','CreateFileA','CreateFileMappingA','CreateFileMappingFromApp','CreateFileMappingNumaA','CreateFileMappingNumaW','CreateFileMappingW','CreateFileTransactedA','CreateFileTransactedW','CreateFileW','CreateHardLinkA','CreateHardLinkTransactedA','CreateHardLinkTransactedW','CreateHardLinkW','CreateIoCompletionPort','CreateJobObjectA','CreateJobObjectW','CreateJobSet','CreateMailslotA','CreateMailslotW','CreateMemoryResourceNotification','CreateMutexA','CreateMutexExA','CreateMutexExW','CreateMutexW','CreateNamedPipeA','CreateNamedPipeW','CreatePipe','CreatePrivateNamespaceA','CreatePrivateNamespaceW','CreateProcessA','CreateProcessAsUserA','CreateProcessAsUserW','CreateProcessInternalA','CreateProcessInternalW','CreateProcessW','CreatePseudoConsole','CreateRemoteThread','CreateRemoteThreadEx','CreateSemaphoreA','CreateSemaphoreExA','CreateSemaphoreExW','CreateSemaphoreW','CreateSymbolicLinkA','CreateSymbolicLinkTransactedA','CreateSymbolicLinkTransactedW','CreateSymbolicLinkW','CreateTapePartition','CreateThread','CreateThreadpool','CreateThreadpoolCleanupGroup','CreateThreadpoolIo','CreateThreadpoolTimer','CreateThreadpoolWait','CreateThreadpoolWork','CreateTimerQueue','CreateTimerQueueTimer','CreateToolhelp32Snapshot','CreateUmsCompletionList','CreateUmsThreadContext','CreateWaitableTimerA','CreateWaitableTimerExA','CreateWaitableTimerExW','CreateWaitableTimerW','CtrlRoutine','DeactivateActCtx','DeactivateActCtxWorker','DebugActiveProcess','DebugActiveProcessStop','DebugBreak','DebugBreakProcess','DebugSetProcessKillOnExit','DecodePointer','DecodeSystemPointer','DefineDosDeviceA','DefineDosDeviceW','DelayLoadFailureHook','DeleteAtom','DeleteBoundaryDescriptor','DeleteCriticalSection','DeleteFiber','DeleteFileA','DeleteFileTransactedA','DeleteFileTransactedW','DeleteFileW','DeleteProcThreadAttributeList','DeleteSynchronizationBarrier','DeleteTimerQueue','DeleteTimerQueueEx','DeleteTimerQueueTimer','DeleteUmsCompletionList','DeleteUmsThreadContext','DeleteVolumeMountPointA','DeleteVolumeMountPointW','DequeueUmsCompletionListItems','DeviceIoControl','DisableThreadLibraryCalls','DisableThreadProfiling','DisassociateCurrentThreadFromCallback','DiscardVirtualMemory','DisconnectNamedPipe','DnsHostnameToComputerNameA','DnsHostnameToComputerNameExW','DnsHostnameToComputerNameW','DosDateTimeToFileTime','DosPathToSessionPathA','DosPathToSessionPathW','DuplicateConsoleHandle','DuplicateEncryptionInfoFileExt','DuplicateHandle','EnableThreadProfiling','EncodePointer','EncodeSystemPointer','EndUpdateResourceA','EndUpdateResourceW','EnterCriticalSection','EnterSynchronizationBarrier','EnterUmsSchedulingMode','EnumCalendarInfoA','EnumCalendarInfoExA','EnumCalendarInfoExEx','EnumCalendarInfoExW','EnumCalendarInfoW','EnumDateFormatsA','EnumDateFormatsExA','EnumDateFormatsExEx','EnumDateFormatsExW','EnumDateFormatsW','EnumLanguageGroupLocalesA','EnumLanguageGroupLocalesW','EnumResourceLanguagesA','EnumResourceLanguagesExA','EnumResourceLanguagesExW','EnumResourceLanguagesW','EnumResourceNamesA','EnumResourceNamesExA','EnumResourceNamesExW','EnumResourceNamesW','EnumResourceTypesA','EnumResourceTypesExA','EnumResourceTypesExW','EnumResourceTypesW','EnumSystemCodePagesA','EnumSystemCodePagesW','EnumSystemFirmwareTables','EnumSystemGeoID','EnumSystemGeoNames','EnumSystemLanguageGroupsA','EnumSystemLanguageGroupsW','EnumSystemLocalesA','EnumSystemLocalesEx','EnumSystemLocalesW','EnumTimeFormatsA','EnumTimeFormatsEx','EnumTimeFormatsW','EnumUILanguagesA','EnumUILanguagesW','EnumerateLocalComputerNamesA','EnumerateLocalComputerNamesW','EraseTape','EscapeCommFunction','ExecuteUmsThread','ExitProcess','ExitThread','ExitVDM','ExpandEnvironmentStringsA','ExpandEnvironmentStringsW','ExpungeConsoleCommandHistoryA','ExpungeConsoleCommandHistoryW','FatalAppExitA','FatalAppExitW','FatalExit','FileTimeToDosDateTime','FileTimeToLocalFileTime','FileTimeToSystemTime','FillConsoleOutputAttribute','FillConsoleOutputCharacterA','FillConsoleOutputCharacterW','FindActCtxSectionGuid','FindActCtxSectionGuidWorker','FindActCtxSectionStringA','FindActCtxSectionStringW','FindActCtxSectionStringWWorker','FindAtomA','FindAtomW','FindClose','FindCloseChangeNotification','FindFirstChangeNotificationA','FindFirstChangeNotificationW','FindFirstFileA','FindFirstFileExA','FindFirstFileExW','FindFirstFileNameTransactedW','FindFirstFileNameW','FindFirstFileTransactedA','FindFirstFileTransactedW','FindFirstFileW','FindFirstStreamTransactedW','FindFirstStreamW','FindFirstVolumeA','FindFirstVolumeMountPointA','FindFirstVolumeMountPointW','FindFirstVolumeW','FindNLSString','FindNLSStringEx','FindNextChangeNotification','FindNextFileA','FindNextFileNameW','FindNextFileW','FindNextStreamW','FindNextVolumeA','FindNextVolumeMountPointA','FindNextVolumeMountPointW','FindNextVolumeW','FindPackagesByPackageFamily','FindResourceA','FindResourceExA','FindResourceExW','FindResourceW','FindStringOrdinal','FindVolumeClose','FindVolumeMountPointClose','FlsAlloc','FlsFree','FlsGetValue','FlsSetValue','FlushConsoleInputBuffer','FlushFileBuffers','FlushInstructionCache','FlushProcessWriteBuffers','FlushViewOfFile','FoldStringA','FoldStringW','FormatApplicationUserModelId','FormatMessageA','FormatMessageW','FreeConsole','FreeEnvironmentStringsA','FreeEnvironmentStringsW','FreeLibrary','FreeLibraryAndExitThread','FreeLibraryWhenCallbackReturns','FreeMemoryJobObject','FreeResource','FreeUserPhysicalPages','GenerateConsoleCtrlEvent','GetACP','GetActiveProcessorCount','GetActiveProcessorGroupCount','GetAppContainerAce','GetAppContainerNamedObjectPath','GetApplicationRecoveryCallback','GetApplicationRecoveryCallbackWorker','GetApplicationRestartSettings','GetApplicationRestartSettingsWorker','GetApplicationUserModelId','GetAtomNameA','GetAtomNameW','GetBinaryType','GetBinaryTypeA','GetBinaryTypeW','GetCPInfo','GetCPInfoExA','GetCPInfoExW','GetCachedSigningLevel','GetCalendarDateFormat','GetCalendarDateFormatEx','GetCalendarDaysInMonth','GetCalendarDifferenceInDays','GetCalendarInfoA','GetCalendarInfoEx','GetCalendarInfoW','GetCalendarMonthsInYear','GetCalendarSupportedDateRange','GetCalendarWeekNumber','GetComPlusPackageInstallStatus','GetCommConfig','GetCommMask','GetCommModemStatus','GetCommProperties','GetCommState','GetCommTimeouts','GetCommandLineA','GetCommandLineW','GetCompressedFileSizeA','GetCompressedFileSizeTransactedA','GetCompressedFileSizeTransactedW','GetCompressedFileSizeW','GetComputerNameA','GetComputerNameExA','GetComputerNameExW','GetComputerNameW','GetConsoleAliasA','GetConsoleAliasExesA','GetConsoleAliasExesLengthA','GetConsoleAliasExesLengthW','GetConsoleAliasExesW','GetConsoleAliasW','GetConsoleAliasesA','GetConsoleAliasesLengthA','GetConsoleAliasesLengthW','GetConsoleAliasesW','GetConsoleCP','GetConsoleCharType','GetConsoleCommandHistoryA','GetConsoleCommandHistoryLengthA','GetConsoleCommandHistoryLengthW','GetConsoleCommandHistoryW','GetConsoleCursorInfo','GetConsoleCursorMode','GetConsoleDisplayMode','GetConsoleFontInfo','GetConsoleFontSize','GetConsoleHardwareState','GetConsoleHistoryInfo','GetConsoleInputExeNameA','GetConsoleInputExeNameW','GetConsoleInputWaitHandle','GetConsoleKeyboardLayoutNameA','GetConsoleKeyboardLayoutNameW','GetConsoleMode','GetConsoleNlsMode','GetConsoleOriginalTitleA','GetConsoleOriginalTitleW','GetConsoleOutputCP','GetConsoleProcessList','GetConsoleScreenBufferInfo','GetConsoleScreenBufferInfoEx','GetConsoleSelectionInfo','GetConsoleTitleA','GetConsoleTitleW','GetConsoleWindow','GetCurrencyFormatA','GetCurrencyFormatEx','GetCurrencyFormatW','GetCurrentActCtx','GetCurrentActCtxWorker','GetCurrentApplicationUserModelId','GetCurrentConsoleFont','GetCurrentConsoleFontEx','GetCurrentDirectoryA','GetCurrentDirectoryW','GetCurrentPackageFamilyName','GetCurrentPackageFullName','GetCurrentPackageId','GetCurrentPackageInfo','GetCurrentPackagePath','GetCurrentProcess','GetCurrentProcessId','GetCurrentProcessorNumber','GetCurrentProcessorNumberEx','GetCurrentThread','GetCurrentThreadId','GetCurrentThreadStackLimits','GetCurrentUmsThread','GetDateFormatA','GetDateFormatAWorker','GetDateFormatEx','GetDateFormatW','GetDateFormatWWorker','GetDefaultCommConfigA','GetDefaultCommConfigW','GetDevicePowerState','GetDiskFreeSpaceA','GetDiskFreeSpaceExA','GetDiskFreeSpaceExW','GetDiskFreeSpaceW','GetDiskSpaceInformationA','GetDiskSpaceInformationW','GetDllDirectoryA','GetDllDirectoryW','GetDriveTypeA','GetDriveTypeW','GetDurationFormat','GetDurationFormatEx','GetDynamicTimeZoneInformation','GetEnabledXStateFeatures','GetEncryptedFileVersionExt','GetEnvironmentStrings','GetEnvironmentStringsA','GetEnvironmentStringsW','GetEnvironmentVariableA','GetEnvironmentVariableW','GetEraNameCountedString','GetErrorMode','GetExitCodeProcess','GetExitCodeThread','GetExpandedNameA','GetExpandedNameW','GetFileAttributesA','GetFileAttributesExA','GetFileAttributesExW','GetFileAttributesTransactedA','GetFileAttributesTransactedW','GetFileAttributesW','GetFileBandwidthReservation','GetFileInformationByHandle','GetFileInformationByHandleEx','GetFileMUIInfo','GetFileMUIPath','GetFileSize','GetFileSizeEx','GetFileTime','GetFileType','GetFinalPathNameByHandleA','GetFinalPathNameByHandleW','GetFirmwareEnvironmentVariableA','GetFirmwareEnvironmentVariableExA','GetFirmwareEnvironmentVariableExW','GetFirmwareEnvironmentVariableW','GetFirmwareType','GetFullPathNameA','GetFullPathNameTransactedA','GetFullPathNameTransactedW','GetFullPathNameW','GetGeoInfoA','GetGeoInfoEx','GetGeoInfoW','GetHandleInformation','GetLargePageMinimum','GetLargestConsoleWindowSize','GetLastError','GetLocalTime','GetLocaleInfoA','GetLocaleInfoEx','GetLocaleInfoW','GetLogicalDriveStringsA','GetLogicalDriveStringsW','GetLogicalDrives','GetLogicalProcessorInformation','GetLogicalProcessorInformationEx','GetLongPathNameA','GetLongPathNameTransactedA','GetLongPathNameTransactedW','GetLongPathNameW','GetMailslotInfo','GetMaximumProcessorCount','GetMaximumProcessorGroupCount','GetMemoryErrorHandlingCapabilities','GetModuleFileNameA','GetModuleFileNameW','GetModuleHandleA','GetModuleHandleExA','GetModuleHandleExW','GetModuleHandleW','GetNLSVersion','GetNLSVersionEx','GetNamedPipeAttribute','GetNamedPipeClientComputerNameA','GetNamedPipeClientComputerNameW','GetNamedPipeClientProcessId','GetNamedPipeClientSessionId','GetNamedPipeHandleStateA','GetNamedPipeHandleStateW','GetNamedPipeInfo','GetNamedPipeServerProcessId','GetNamedPipeServerSessionId','GetNativeSystemInfo','GetNextUmsListItem','GetNextVDMCommand','GetNumaAvailableMemoryNode','GetNumaAvailableMemoryNodeEx','GetNumaHighestNodeNumber','GetNumaNodeNumberFromHandle','GetNumaNodeProcessorMask','GetNumaNodeProcessorMaskEx','GetNumaProcessorNode','GetNumaProcessorNodeEx','GetNumaProximityNode','GetNumaProximityNodeEx','GetNumberFormatA','GetNumberFormatEx','GetNumberFormatW','GetNumberOfConsoleFonts','GetNumberOfConsoleInputEvents','GetNumberOfConsoleMouseButtons','GetOEMCP','GetOverlappedResult','GetOverlappedResultEx','GetPackageApplicationIds','GetPackageFamilyName','GetPackageFullName','GetPackageId','GetPackageInfo','GetPackagePath','GetPackagePathByFullName','GetPackagesByPackageFamily','GetPhysicallyInstalledSystemMemory','GetPriorityClass','GetPrivateProfileIntA','GetPrivateProfileIntW','GetPrivateProfileSectionA','GetPrivateProfileSectionNamesA','GetPrivateProfileSectionNamesW','GetPrivateProfileSectionW','GetPrivateProfileStringA','GetPrivateProfileStringW','GetPrivateProfileStructA','GetPrivateProfileStructW','GetProcAddress','GetProcessAffinityMask','GetProcessDEPPolicy','GetProcessDefaultCpuSets','GetProcessGroupAffinity','GetProcessHandleCount','GetProcessHeap','GetProcessHeaps','GetProcessId','GetProcessIdOfThread','GetProcessInformation','GetProcessIoCounters','GetProcessMitigationPolicy','GetProcessPreferredUILanguages','GetProcessPriorityBoost','GetProcessShutdownParameters','GetProcessTimes','GetProcessVersion','GetProcessWorkingSetSize','GetProcessWorkingSetSizeEx','GetProcessorSystemCycleTime','GetProductInfo','GetProfileIntA','GetProfileIntW','GetProfileSectionA','GetProfileSectionW','GetProfileStringA','GetProfileStringW','GetQueuedCompletionStatus','GetQueuedCompletionStatusEx','GetShortPathNameA','GetShortPathNameW','GetStagedPackagePathByFullName','GetStartupInfoA','GetStartupInfoW','GetStateFolder','GetStdHandle','GetStringScripts','GetStringTypeA','GetStringTypeExA','GetStringTypeExW','GetStringTypeW','GetSystemAppDataKey','GetSystemCpuSetInformation','GetSystemDEPPolicy','GetSystemDefaultLCID','GetSystemDefaultLangID','GetSystemDefaultLocaleName','GetSystemDefaultUILanguage','GetSystemDirectoryA','GetSystemDirectoryW','GetSystemFileCacheSize','GetSystemFirmwareTable','GetSystemInfo','GetSystemPowerStatus','GetSystemPreferredUILanguages','GetSystemRegistryQuota','GetSystemTime','GetSystemTimeAdjustment','GetSystemTimeAsFileTime','GetSystemTimePreciseAsFileTime','GetSystemTimes','GetSystemWindowsDirectoryA','GetSystemWindowsDirectoryW','GetSystemWow64DirectoryA','GetSystemWow64DirectoryW','GetTapeParameters','GetTapePosition','GetTapeStatus','GetTempFileNameA','GetTempFileNameW','GetTempPathA','GetTempPathW','GetThreadContext','GetThreadDescription','GetThreadErrorMode','GetThreadGroupAffinity','GetThreadIOPendingFlag','GetThreadId','GetThreadIdealProcessorEx','GetThreadInformation','GetThreadLocale','GetThreadPreferredUILanguages','GetThreadPriority','GetThreadPriorityBoost','GetThreadSelectedCpuSets','GetThreadSelectorEntry','GetThreadTimes','GetThreadUILanguage','GetTickCount','GetTickCount64','GetTimeFormatA','GetTimeFormatAWorker','GetTimeFormatEx','GetTimeFormatW','GetTimeFormatWWorker','GetTimeZoneInformation','GetTimeZoneInformationForYear','GetUILanguageInfo','GetUmsCompletionListEvent','GetUmsSystemThreadInformation','GetUserDefaultGeoName','GetUserDefaultLCID','GetUserDefaultLangID','GetUserDefaultLocaleName','GetUserDefaultUILanguage','GetUserGeoID','GetUserPreferredUILanguages','GetVDMCurrentDirectories','GetVersion','GetVersionExA','GetVersionExW','GetVolumeInformationA','GetVolumeInformationByHandleW','GetVolumeInformationW','GetVolumeNameForVolumeMountPointA','GetVolumeNameForVolumeMountPointW','GetVolumePathNameA','GetVolumePathNameW','GetVolumePathNamesForVolumeNameA','GetVolumePathNamesForVolumeNameW','GetWindowsDirectoryA','GetWindowsDirectoryW','GetWriteWatch','GetXStateFeaturesMask','GlobalAddAtomA','GlobalAddAtomExA','GlobalAddAtomExW','GlobalAddAtomW','GlobalAlloc','GlobalCompact','GlobalDeleteAtom','GlobalFindAtomA','GlobalFindAtomW','GlobalFix','GlobalFlags','GlobalFree','GlobalGetAtomNameA','GlobalGetAtomNameW','GlobalHandle','GlobalLock','GlobalMemoryStatus','GlobalMemoryStatusEx','GlobalReAlloc','GlobalSize','GlobalUnWire','GlobalUnfix','GlobalUnlock','GlobalWire','Heap32First','Heap32ListFirst','Heap32ListNext','Heap32Next','HeapAlloc','HeapCompact','HeapCreate','HeapDestroy','HeapFree','HeapLock','HeapQueryInformation','HeapReAlloc','HeapSetInformation','HeapSize','HeapSummary','HeapUnlock','HeapValidate','HeapWalk','IdnToAscii','IdnToNameprepUnicode','IdnToUnicode','InitAtomTable','InitOnceBeginInitialize','InitOnceComplete','InitOnceExecuteOnce','InitOnceInitialize','InitializeConditionVariable','InitializeContext','InitializeContext2','InitializeCriticalSection','InitializeCriticalSectionAndSpinCount','InitializeCriticalSectionEx','InitializeEnclave','InitializeProcThreadAttributeList','InitializeSListHead','InitializeSRWLock','InitializeSynchronizationBarrier','InstallELAMCertificateInfo','InterlockedFlushSList','InterlockedPopEntrySList','InterlockedPushEntrySList','InterlockedPushListSList','InterlockedPushListSListEx','InvalidateConsoleDIBits','IsBadCodePtr','IsBadHugeReadPtr','IsBadHugeWritePtr','IsBadReadPtr','IsBadStringPtrA','IsBadStringPtrW','IsBadWritePtr','IsCalendarLeapDay','IsCalendarLeapMonth','IsCalendarLeapYear','IsDBCSLeadByte','IsDBCSLeadByteEx','IsDebuggerPresent','IsEnclaveTypeSupported','IsNLSDefinedString','IsNativeVhdBoot','IsNormalizedString','IsProcessCritical','IsProcessInJob','IsProcessorFeaturePresent','IsSystemResumeAutomatic','IsThreadAFiber','IsThreadpoolTimerSet','IsUserCetAvailableInEnvironment','IsValidCalDateTime','IsValidCodePage','IsValidLanguageGroup','IsValidLocale','IsValidLocaleName','IsValidNLSVersion','IsWow64GuestMachineSupported','IsWow64Process','IsWow64Process2','K32EmptyWorkingSet','K32EnumDeviceDrivers','K32EnumPageFilesA','K32EnumPageFilesW','K32EnumProcessModules','K32EnumProcessModulesEx','K32EnumProcesses','K32GetDeviceDriverBaseNameA','K32GetDeviceDriverBaseNameW','K32GetDeviceDriverFileNameA','K32GetDeviceDriverFileNameW','K32GetMappedFileNameA','K32GetMappedFileNameW','K32GetModuleBaseNameA','K32GetModuleBaseNameW','K32GetModuleFileNameExA','K32GetModuleFileNameExW','K32GetModuleInformation','K32GetPerformanceInfo','K32GetProcessImageFileNameA','K32GetProcessImageFileNameW','K32GetProcessMemoryInfo','K32GetWsChanges','K32GetWsChangesEx','K32InitializeProcessForWsWatch','K32QueryWorkingSet','K32QueryWorkingSetEx','LCIDToLocaleName','LCMapStringA','LCMapStringEx','LCMapStringW','LZClose','LZCloseFile','LZCopy','LZCreateFileW','LZDone','LZInit','LZOpenFileA','LZOpenFileW','LZRead','LZSeek','LZStart','LeaveCriticalSection','LeaveCriticalSectionWhenCallbackReturns','LoadAppInitDlls','LoadEnclaveData','LoadLibraryA','LoadLibraryExA','LoadLibraryExW','LoadLibraryW','LoadModule','LoadPackagedLibrary','LoadResource','LoadStringBaseExW','LoadStringBaseW','LocalAlloc','LocalCompact','LocalFileTimeToFileTime','LocalFileTimeToLocalSystemTime','LocalFlags','LocalFree','LocalHandle','LocalLock','LocalReAlloc','LocalShrink','LocalSize','LocalSystemTimeToLocalFileTime','LocalUnlock','LocaleNameToLCID','LocateXStateFeature','LockFile','LockFileEx','LockResource','MapUserPhysicalPages','MapUserPhysicalPagesScatter','MapViewOfFile','MapViewOfFileEx','MapViewOfFileExNuma','MapViewOfFileFromApp','Module32First','Module32FirstW','Module32Next','Module32NextW','MoveFileA','MoveFileExA','MoveFileExW','MoveFileTransactedA','MoveFileTransactedW','MoveFileW','MoveFileWithProgressA','MoveFileWithProgressW','MulDiv','MultiByteToWideChar','NeedCurrentDirectoryForExePathA','NeedCurrentDirectoryForExePathW','NlsCheckPolicy','NlsGetCacheUpdateCount','NlsUpdateLocale','NlsUpdateSystemLocale','NormalizeString','NotifyMountMgr','NotifyUILanguageChange','NtVdm64CreateProcessInternalW','OOBEComplete','OfferVirtualMemory','OpenConsoleW','OpenConsoleWStub','OpenEventA','OpenEventW','OpenFile','OpenFileById','OpenFileMappingA','OpenFileMappingW','OpenJobObjectA','OpenJobObjectW','OpenMutexA','OpenMutexW','OpenPackageInfoByFullName','OpenPrivateNamespaceA','OpenPrivateNamespaceW','OpenProcess','OpenProcessToken','OpenProfileUserMapping','OpenSemaphoreA','OpenSemaphoreW','OpenState','OpenStateExplicit','OpenThread','OpenThreadToken','OpenWaitableTimerA','OpenWaitableTimerW','OutputDebugStringA','OutputDebugStringW','PackageFamilyNameFromFullName','PackageFamilyNameFromId','PackageFullNameFromId','PackageIdFromFullName','PackageNameAndPublisherIdFromFamilyName','ParseApplicationUserModelId','PeekConsoleInputA','PeekConsoleInputW','PeekNamedPipe','PostQueuedCompletionStatus','PowerClearRequest','PowerCreateRequest','PowerSetRequest','PrefetchVirtualMemory','PrepareTape','PrivCopyFileExW','PrivMoveFileIdentityW','Process32First','Process32FirstW','Process32Next','Process32NextW','ProcessIdToSessionId','PssCaptureSnapshot','PssDuplicateSnapshot','PssFreeSnapshot','PssQuerySnapshot','PssWalkMarkerCreate','PssWalkMarkerFree','PssWalkMarkerGetPosition','PssWalkMarkerRewind','PssWalkMarkerSeek','PssWalkMarkerSeekToBeginning','PssWalkMarkerSetPosition','PssWalkMarkerTell','PssWalkSnapshot','PulseEvent','PurgeComm','QueryActCtxSettingsW','QueryActCtxSettingsWWorker','QueryActCtxW','QueryActCtxWWorker','QueryDepthSList','QueryDosDeviceA','QueryDosDeviceW','QueryFullProcessImageNameA','QueryFullProcessImageNameW','QueryIdleProcessorCycleTime','QueryIdleProcessorCycleTimeEx','QueryInformationJobObject','QueryIoRateControlInformationJobObject','QueryMemoryResourceNotification','QueryPerformanceCounter','QueryPerformanceFrequency','QueryProcessAffinityUpdateMode','QueryProcessCycleTime','QueryProtectedPolicy','QueryThreadCycleTime','QueryThreadProfiling','QueryThreadpoolStackInformation','QueryUmsThreadInformation','QueryUnbiasedInterruptTime','QueueUserAPC','QueueUserAPC2','QueueUserWorkItem','QuirkGetData2Worker','QuirkGetDataWorker','QuirkIsEnabled2Worker','QuirkIsEnabled3Worker','QuirkIsEnabledForPackage2Worker','QuirkIsEnabledForPackage3Worker','QuirkIsEnabledForPackage4Worker','QuirkIsEnabledForPackageWorker','QuirkIsEnabledForProcessWorker','QuirkIsEnabledWorker','RaiseException','RaiseFailFastException','RaiseInvalid16BitExeError','ReOpenFile','ReadConsoleA','ReadConsoleInputA','ReadConsoleInputExA','ReadConsoleInputExW','ReadConsoleInputW','ReadConsoleOutputA','ReadConsoleOutputAttribute','ReadConsoleOutputCharacterA','ReadConsoleOutputCharacterW','ReadConsoleOutputW','ReadConsoleW','ReadDirectoryChangesExW','ReadDirectoryChangesW','ReadFile','ReadFileEx','ReadFileScatter','ReadProcessMemory','ReadThreadProfilingData','ReclaimVirtualMemory','RegCloseKey','RegCopyTreeW','RegCreateKeyExA','RegCreateKeyExW','RegDeleteKeyExA','RegDeleteKeyExW','RegDeleteTreeA','RegDeleteTreeW','RegDeleteValueA','RegDeleteValueW','RegDisablePredefinedCacheEx','RegEnumKeyExA','RegEnumKeyExW','RegEnumValueA','RegEnumValueW','RegFlushKey','RegGetKeySecurity','RegGetValueA','RegGetValueW','RegLoadKeyA','RegLoadKeyW','RegLoadMUIStringA','RegLoadMUIStringW','RegNotifyChangeKeyValue','RegOpenCurrentUser','RegOpenKeyExA','RegOpenKeyExW','RegOpenUserClassesRoot','RegQueryInfoKeyA','RegQueryInfoKeyW','RegQueryValueExA','RegQueryValueExW','RegRestoreKeyA','RegRestoreKeyW','RegSaveKeyExA','RegSaveKeyExW','RegSetKeySecurity','RegSetValueExA','RegSetValueExW','RegUnLoadKeyA','RegUnLoadKeyW','RegisterApplicationRecoveryCallback','RegisterApplicationRestart','RegisterBadMemoryNotification','RegisterConsoleIME','RegisterConsoleOS2','RegisterConsoleVDM','RegisterWaitForInputIdle','RegisterWaitForSingleObject','RegisterWaitForSingleObjectEx','RegisterWaitUntilOOBECompleted','RegisterWowBaseHandlers','RegisterWowExec','ReleaseActCtx','ReleaseActCtxWorker','ReleaseMutex','ReleaseMutexWhenCallbackReturns','ReleaseSRWLockExclusive','ReleaseSRWLockShared','ReleaseSemaphore','ReleaseSemaphoreWhenCallbackReturns','RemoveDirectoryA','RemoveDirectoryTransactedA','RemoveDirectoryTransactedW','RemoveDirectoryW','RemoveDllDirectory','RemoveLocalAlternateComputerNameA','RemoveLocalAlternateComputerNameW','RemoveSecureMemoryCacheCallback','RemoveVectoredContinueHandler','RemoveVectoredExceptionHandler','ReplaceFile','ReplaceFileA','ReplaceFileW','ReplacePartitionUnit','RequestDeviceWakeup','RequestWakeupLatency','ResetEvent','ResetWriteWatch','ResizePseudoConsole','ResolveDelayLoadedAPI','ResolveDelayLoadsFromDll','ResolveLocaleName','RestoreLastError','ResumeThread','RtlAddFunctionTable','RtlCaptureContext','RtlCaptureStackBackTrace','RtlCompareMemory','RtlCopyMemory','RtlDeleteFunctionTable','RtlFillMemory','RtlInstallFunctionTableCallback','RtlLookupFunctionEntry','RtlMoveMemory','RtlPcToFileHeader','RtlRaiseException','RtlRestoreContext','RtlUnwind','RtlUnwindEx','RtlVirtualUnwind','RtlZeroMemory','ScrollConsoleScreenBufferA','ScrollConsoleScreenBufferW','SearchPathA','SearchPathW','SetCachedSigningLevel','SetCalendarInfoA','SetCalendarInfoW','SetComPlusPackageInstallStatus','SetCommBreak','SetCommConfig','SetCommMask','SetCommState','SetCommTimeouts','SetComputerNameA','SetComputerNameEx2W','SetComputerNameExA','SetComputerNameExW','SetComputerNameW','SetConsoleActiveScreenBuffer','SetConsoleCP','SetConsoleCtrlHandler','SetConsoleCursor','SetConsoleCursorInfo','SetConsoleCursorMode','SetConsoleCursorPosition','SetConsoleDisplayMode','SetConsoleFont','SetConsoleHardwareState','SetConsoleHistoryInfo','SetConsoleIcon','SetConsoleInputExeNameA','SetConsoleInputExeNameW','SetConsoleKeyShortcuts','SetConsoleLocalEUDC','SetConsoleMaximumWindowSize','SetConsoleMenuClose','SetConsoleMode','SetConsoleNlsMode','SetConsoleNumberOfCommandsA','SetConsoleNumberOfCommandsW','SetConsoleOS2OemFormat','SetConsoleOutputCP','SetConsolePalette','SetConsoleScreenBufferInfoEx','SetConsoleScreenBufferSize','SetConsoleTextAttribute','SetConsoleTitleA','SetConsoleTitleW','SetConsoleWindowInfo','SetCriticalSectionSpinCount','SetCurrentConsoleFontEx','SetCurrentDirectoryA','SetCurrentDirectoryW','SetDefaultCommConfigA','SetDefaultCommConfigW','SetDefaultDllDirectories','SetDllDirectoryA','SetDllDirectoryW','SetDynamicTimeZoneInformation','SetEndOfFile','SetEnvironmentStringsA','SetEnvironmentStringsW','SetEnvironmentVariableA','SetEnvironmentVariableW','SetErrorMode','SetEvent','SetEventWhenCallbackReturns','SetFileApisToANSI','SetFileApisToOEM','SetFileAttributesA','SetFileAttributesTransactedA','SetFileAttributesTransactedW','SetFileAttributesW','SetFileBandwidthReservation','SetFileCompletionNotificationModes','SetFileInformationByHandle','SetFileIoOverlappedRange','SetFilePointer','SetFilePointerEx','SetFileShortNameA','SetFileShortNameW','SetFileTime','SetFileValidData','SetFirmwareEnvironmentVariableA','SetFirmwareEnvironmentVariableExA','SetFirmwareEnvironmentVariableExW','SetFirmwareEnvironmentVariableW','SetHandleCount','SetHandleInformation','SetInformationJobObject','SetIoRateControlInformationJobObject','SetLastConsoleEventActive','SetLastError','SetLocalPrimaryComputerNameA','SetLocalPrimaryComputerNameW','SetLocalTime','SetLocaleInfoA','SetLocaleInfoW','SetMailslotInfo','SetMessageWaitingIndicator','SetNamedPipeAttribute','SetNamedPipeHandleState','SetPriorityClass','SetProcessAffinityMask','SetProcessAffinityUpdateMode','SetProcessDEPPolicy','SetProcessDefaultCpuSets','SetProcessDynamicEHContinuationTargets','SetProcessDynamicEnforcedCetCompatibleRanges','SetProcessInformation','SetProcessMitigationPolicy','SetProcessPreferredUILanguages','SetProcessPriorityBoost','SetProcessShutdownParameters','SetProcessWorkingSetSize','SetProcessWorkingSetSizeEx','SetProtectedPolicy','SetSearchPathMode','SetStdHandle','SetStdHandleEx','SetSystemFileCacheSize','SetSystemPowerState','SetSystemTime','SetSystemTimeAdjustment','SetTapeParameters','SetTapePosition','SetTermsrvAppInstallMode','SetThreadAffinityMask','SetThreadContext','SetThreadDescription','SetThreadErrorMode','SetThreadExecutionState','SetThreadGroupAffinity','SetThreadIdealProcessor','SetThreadIdealProcessorEx','SetThreadInformation','SetThreadLocale','SetThreadPreferredUILanguages','SetThreadPriority','SetThreadPriorityBoost','SetThreadSelectedCpuSets','SetThreadStackGuarantee','SetThreadToken','SetThreadUILanguage','SetThreadpoolStackInformation','SetThreadpoolThreadMaximum','SetThreadpoolThreadMinimum','SetThreadpoolTimer','SetThreadpoolTimerEx','SetThreadpoolWait','SetThreadpoolWaitEx','SetTimeZoneInformation','SetTimerQueueTimer','SetUmsThreadInformation','SetUnhandledExceptionFilter','SetUserGeoID','SetUserGeoName','SetVDMCurrentDirectories','SetVolumeLabelA','SetVolumeLabelW','SetVolumeMountPointA','SetVolumeMountPointW','SetVolumeMountPointWStub','SetWaitableTimer','SetWaitableTimerEx','SetXStateFeaturesMask','SetupComm','ShowConsoleCursor','SignalObjectAndWait','SizeofResource','Sleep','SleepConditionVariableCS','SleepConditionVariableSRW','SleepEx','SortCloseHandle','SortGetHandle','StartThreadpoolIo','SubmitThreadpoolWork','SuspendThread','SwitchToFiber','SwitchToThread','SystemTimeToFileTime','SystemTimeToTzSpecificLocalTime','SystemTimeToTzSpecificLocalTimeEx','TerminateJobObject','TerminateProcess','TerminateThread','TermsrvAppInstallMode','TermsrvConvertSysRootToUserDir','TermsrvCreateRegEntry','TermsrvDeleteKey','TermsrvDeleteValue','TermsrvGetPreSetValue','TermsrvGetWindowsDirectoryA','TermsrvGetWindowsDirectoryW','TermsrvOpenRegEntry','TermsrvOpenUserClasses','TermsrvRestoreKey','TermsrvSetKeySecurity','TermsrvSetValueKey','TermsrvSyncUserIniFileExt','Thread32First','Thread32Next','TlsAlloc','TlsFree','TlsGetValue','TlsSetValue','Toolhelp32ReadProcessMemory','TransactNamedPipe','TransmitCommChar','TryAcquireSRWLockExclusive','TryAcquireSRWLockShared','TryEnterCriticalSection','TrySubmitThreadpoolCallback','TzSpecificLocalTimeToSystemTime','TzSpecificLocalTimeToSystemTimeEx','UTRegister','UTUnRegister','UmsThreadYield','UnhandledExceptionFilter','UnlockFile','UnlockFileEx','UnmapViewOfFile','UnmapViewOfFileEx','UnregisterApplicationRecoveryCallback','UnregisterApplicationRestart','UnregisterBadMemoryNotification','UnregisterConsoleIME','UnregisterWait','UnregisterWaitEx','UnregisterWaitUntilOOBECompleted','UpdateCalendarDayOfWeek','UpdateProcThreadAttribute','UpdateResourceA','UpdateResourceW','VDMConsoleOperation','VDMOperationStarted','VerLanguageNameA','VerLanguageNameW','VerSetConditionMask','VerifyConsoleIoHandle','VerifyScripts','VerifyVersionInfoA','VerifyVersionInfoW','VirtualAlloc','VirtualAllocEx','VirtualAllocExNuma','VirtualFree','VirtualFreeEx','VirtualLock','VirtualProtect','VirtualProtectEx','VirtualQuery','VirtualQueryEx','VirtualUnlock','WTSGetActiveConsoleSessionId','WaitCommEvent','WaitForDebugEvent','WaitForDebugEventEx','WaitForMultipleObjects','WaitForMultipleObjectsEx','WaitForSingleObject','WaitForSingleObjectEx','WaitForThreadpoolIoCallbacks','WaitForThreadpoolTimerCallbacks','WaitForThreadpoolWaitCallbacks','WaitForThreadpoolWorkCallbacks','WaitNamedPipeA','WaitNamedPipeW','WakeAllConditionVariable','WakeConditionVariable','WerGetFlags','WerGetFlagsWorker','WerRegisterAdditionalProcess','WerRegisterAppLocalDump','WerRegisterCustomMetadata','WerRegisterExcludedMemoryBlock','WerRegisterFile','WerRegisterFileWorker','WerRegisterMemoryBlock','WerRegisterMemoryBlockWorker','WerRegisterRuntimeExceptionModule','WerRegisterRuntimeExceptionModuleWorker','WerSetFlags','WerSetFlagsWorker','WerUnregisterAdditionalProcess','WerUnregisterAppLocalDump','WerUnregisterCustomMetadata','WerUnregisterExcludedMemoryBlock','WerUnregisterFile','WerUnregisterFileWorker','WerUnregisterMemoryBlock','WerUnregisterMemoryBlockWorker','WerUnregisterRuntimeExceptionModule','WerUnregisterRuntimeExceptionModuleWorker','WerpGetDebugger','WerpInitiateRemoteRecovery','WerpLaunchAeDebug','WerpNotifyLoadStringResourceWorker','WerpNotifyUseStringResourceWorker','WideCharToMultiByte','WinExec','Wow64DisableWow64FsRedirection','Wow64EnableWow64FsRedirection','Wow64GetThreadContext','Wow64GetThreadSelectorEntry','Wow64RevertWow64FsRedirection','Wow64SetThreadContext','Wow64SuspendThread','WriteConsoleA','WriteConsoleInputA','WriteConsoleInputVDMA','WriteConsoleInputVDMW','WriteConsoleInputW','WriteConsoleOutputA','WriteConsoleOutputAttribute','WriteConsoleOutputCharacterA','WriteConsoleOutputCharacterW','WriteConsoleOutputW','WriteConsoleW','WriteFile','WriteFileEx','WriteFileGather','WritePrivateProfileSectionA','WritePrivateProfileSectionW','WritePrivateProfileStringA','WritePrivateProfileStringW','WritePrivateProfileStructA','WritePrivateProfileStructW','WriteProcessMemory','WriteProfileSectionA','WriteProfileSectionW','WriteProfileStringA','WriteProfileStringW','WriteTapemark','ZombifyActCtx','ZombifyActCtxWorker','__C_specific_handler','__chkstk','__misaligned_access','_hread','_hwrite','_lclose','_lcreat','_llseek','_local_unwind','_lopen','_lread','_lwrite','lstrcat','lstrcatA','lstrcatW','lstrcmp','lstrcmpA','lstrcmpW','lstrcmpi','lstrcmpiA','lstrcmpiW','lstrcpy','lstrcpyA','lstrcpyW','lstrcpyn','lstrcpynA','lstrcpynW','lstrlen','lstrlenA','lstrlenW','timeBeginPeriod','timeEndPeriod','timeGetDevCaps','timeGetSystemTime','timeGetTime','uaw_lstrcmpW','uaw_lstrcmpiW','uaw_lstrlenW','uaw_wcschr','uaw_wcscpy','uaw_wcsicmp','uaw_wcslen','uaw_wcsrchr']
# wininet.dll APIs
api_list_wininet = ['AppCacheCheckManifest','AppCacheCloseHandle','AppCacheCreateAndCommitFile','AppCacheDeleteGroup','AppCacheDeleteIEGroup','AppCacheDuplicateHandle','AppCacheFinalize','AppCacheFreeDownloadList','AppCacheFreeGroupList','AppCacheFreeIESpace','AppCacheFreeSpace','AppCacheGetDownloadList','AppCacheGetFallbackUrl','AppCacheGetGroupList','AppCacheGetIEGroupList','AppCacheGetInfo','AppCacheGetManifestUrl','AppCacheLookup','CommitUrlCacheEntryA','CommitUrlCacheEntryBinaryBlob','CommitUrlCacheEntryW','CreateMD5SSOHash','CreateUrlCacheContainerA','CreateUrlCacheContainerW','CreateUrlCacheEntryA','CreateUrlCacheEntryExW','CreateUrlCacheEntryW','CreateUrlCacheGroup','DeleteIE3Cache','DeleteUrlCacheContainerA','DeleteUrlCacheContainerW','DeleteUrlCacheEntry','DeleteUrlCacheEntryA','DeleteUrlCacheEntryW','DeleteUrlCacheGroup','DeleteWpadCacheForNetworks','DetectAutoProxyUrl','DispatchAPICall','DllCanUnloadNow','DllGetClassObject','DllInstall','DllRegisterServer','DllUnregisterServer','FindCloseUrlCache','FindFirstUrlCacheContainerA','FindFirstUrlCacheContainerW','FindFirstUrlCacheEntryA','FindFirstUrlCacheEntryExA','FindFirstUrlCacheEntryExW','FindFirstUrlCacheEntryW','FindFirstUrlCacheGroup','FindNextUrlCacheContainerA','FindNextUrlCacheContainerW','FindNextUrlCacheEntryA','FindNextUrlCacheEntryExA','FindNextUrlCacheEntryExW','FindNextUrlCacheEntryW','FindNextUrlCacheGroup','ForceNexusLookup','ForceNexusLookupExW','FreeUrlCacheSpaceA','FreeUrlCacheSpaceW','FtpCommandA','FtpCommandW','FtpCreateDirectoryA','FtpCreateDirectoryW','FtpDeleteFileA','FtpDeleteFileW','FtpFindFirstFileA','FtpFindFirstFileW','FtpGetCurrentDirectoryA','FtpGetCurrentDirectoryW','FtpGetFileA','FtpGetFileEx','FtpGetFileSize','FtpGetFileW','FtpOpenFileA','FtpOpenFileW','FtpPutFileA','FtpPutFileEx','FtpPutFileW','FtpRemoveDirectoryA','FtpRemoveDirectoryW','FtpRenameFileA','FtpRenameFileW','FtpSetCurrentDirectoryA','FtpSetCurrentDirectoryW','GetProxyDllInfo','GetUrlCacheConfigInfoA','GetUrlCacheConfigInfoW','GetUrlCacheEntryBinaryBlob','GetUrlCacheEntryInfoA','GetUrlCacheEntryInfoExA','GetUrlCacheEntryInfoExW','GetUrlCacheEntryInfoW','GetUrlCacheGroupAttributeA','GetUrlCacheGroupAttributeW','GetUrlCacheHeaderData','GopherCreateLocatorA','GopherCreateLocatorW','GopherFindFirstFileA','GopherFindFirstFileW','GopherGetAttributeA','GopherGetAttributeW','GopherGetLocatorTypeA','GopherGetLocatorTypeW','GopherOpenFileA','GopherOpenFileW','HttpAddRequestHeadersA','HttpAddRequestHeadersW','HttpCheckDavCompliance','HttpCloseDependencyHandle','HttpDuplicateDependencyHandle','HttpEndRequestA','HttpEndRequestW','HttpGetServerCredentials','HttpGetTunnelSocket','HttpIndicatePageLoadComplete','HttpIsHostHstsEnabled','HttpOpenDependencyHandle','HttpOpenRequestA','HttpOpenRequestW','HttpPushClose','HttpPushEnable','HttpPushWait','HttpQueryInfoA','HttpQueryInfoW','HttpSendRequestA','HttpSendRequestExA','HttpSendRequestExW','HttpSendRequestW','HttpWebSocketClose','HttpWebSocketCompleteUpgrade','HttpWebSocketQueryCloseStatus','HttpWebSocketReceive','HttpWebSocketSend','HttpWebSocketShutdown','IncrementUrlCacheHeaderData','InternetAlgIdToStringA','InternetAlgIdToStringW','InternetAttemptConnect','InternetAutodial','InternetAutodialCallback','InternetAutodialHangup','InternetCanonicalizeUrlA','InternetCanonicalizeUrlW','InternetCheckConnectionA','InternetCheckConnectionW','InternetClearAllPerSiteCookieDecisions','InternetCloseHandle','InternetCombineUrlA','InternetCombineUrlW','InternetConfirmZoneCrossing','InternetConfirmZoneCrossingA','InternetConfirmZoneCrossingW','InternetConnectA','InternetConnectW','InternetConvertUrlFromWireToWideChar','InternetCrackUrlA','InternetCrackUrlW','InternetCreateUrlA','InternetCreateUrlW','InternetDial','InternetDialA','InternetDialW','InternetEnumPerSiteCookieDecisionA','InternetEnumPerSiteCookieDecisionW','InternetErrorDlg','InternetFindNextFileA','InternetFindNextFileW','InternetFortezzaCommand','InternetFreeCookies','InternetFreeProxyInfoList','InternetGetCertByURL','InternetGetCertByURLA','InternetGetConnectedState','InternetGetConnectedStateEx','InternetGetConnectedStateExA','InternetGetConnectedStateExW','InternetGetCookieA','InternetGetCookieEx2','InternetGetCookieExA','InternetGetCookieExW','InternetGetCookieW','InternetGetLastResponseInfoA','InternetGetLastResponseInfoW','InternetGetPerSiteCookieDecisionA','InternetGetPerSiteCookieDecisionW','InternetGetProxyForUrl','InternetGetSecurityInfoByURL','InternetGetSecurityInfoByURLA','InternetGetSecurityInfoByURLW','InternetGoOnline','InternetGoOnlineA','InternetGoOnlineW','InternetHangUp','InternetInitializeAutoProxyDll','InternetLockRequestFile','InternetOpenA','InternetOpenUrlA','InternetOpenUrlW','InternetOpenW','InternetQueryDataAvailable','InternetQueryFortezzaStatus','InternetQueryOptionA','InternetQueryOptionW','InternetReadFile','InternetReadFileExA','InternetReadFileExW','InternetSecurityProtocolToStringA','InternetSecurityProtocolToStringW','InternetSetCookieA','InternetSetCookieEx2','InternetSetCookieExA','InternetSetCookieExW','InternetSetCookieW','InternetSetDialState','InternetSetDialStateA','InternetSetDialStateW','InternetSetFilePointer','InternetSetOptionA','InternetSetOptionExA','InternetSetOptionExW','InternetSetOptionW','InternetSetPerSiteCookieDecisionA','InternetSetPerSiteCookieDecisionW','InternetSetSecureLegacyServersAppCompat','InternetSetStatusCallback','InternetSetStatusCallbackA','InternetSetStatusCallbackW','InternetShowSecurityInfoByURL','InternetShowSecurityInfoByURLA','InternetShowSecurityInfoByURLW','InternetTimeFromSystemTime','InternetTimeFromSystemTimeA','InternetTimeFromSystemTimeW','InternetTimeToSystemTime','InternetTimeToSystemTimeA','InternetTimeToSystemTimeW','InternetUnlockRequestFile','InternetWriteFile','InternetWriteFileExA','InternetWriteFileExW','IsHostInProxyBypassList','IsUrlCacheEntryExpiredA','IsUrlCacheEntryExpiredW','LoadUrlCacheContent','ParseX509EncodedCertificateForListBoxEntry','PrivacyGetZonePreferenceW','PrivacySetZonePreferenceW','ReadUrlCacheEntryStream','ReadUrlCacheEntryStreamEx','RegisterUrlCacheNotification','ResumeSuspendedDownload','RetrieveUrlCacheEntryFileA','RetrieveUrlCacheEntryFileW','RetrieveUrlCacheEntryStreamA','RetrieveUrlCacheEntryStreamW','RunOnceUrlCache','SetUrlCacheConfigInfoA','SetUrlCacheConfigInfoW','SetUrlCacheEntryGroup','SetUrlCacheEntryGroupA','SetUrlCacheEntryGroupW','SetUrlCacheEntryInfoA','SetUrlCacheEntryInfoW','SetUrlCacheGroupAttributeA','SetUrlCacheGroupAttributeW','SetUrlCacheHeaderData','ShowCertificate','ShowClientAuthCerts','ShowSecurityInfo','ShowX509EncodedCertificate','UnlockUrlCacheEntryFile','UnlockUrlCacheEntryFileA','UnlockUrlCacheEntryFileW','UnlockUrlCacheEntryStream','UpdateUrlCacheContentPath','UrlCacheCheckEntriesExist','UrlCacheCloseEntryHandle','UrlCacheContainerSetEntryMaximumAge','UrlCacheCreateContainer','UrlCacheFindFirstEntry','UrlCacheFindNextEntry','UrlCacheFreeEntryInfo','UrlCacheFreeGlobalSpace','UrlCacheGetContentPaths','UrlCacheGetEntryInfo','UrlCacheGetGlobalCacheSize','UrlCacheGetGlobalLimit','UrlCacheReadEntryStream','UrlCacheReloadSettings','UrlCacheRetrieveEntryFile','UrlCacheRetrieveEntryStream','UrlCacheServer','UrlCacheSetGlobalLimit','UrlCacheUpdateEntryExtraData','UrlZonesDetach','_GetFileExtensionFromUrl']
# sqlite3 dll APIs
api_list_sqlite3 = ['sqlite3_aggregate_context', 'sqlite3_aggregate_count', 'sqlite3_auto_extension', 'sqlite3_backup_finish', 'sqlite3_backup_init', 'sqlite3_backup_pagecount', 'sqlite3_backup_remaining', 'sqlite3_backup_step', 'sqlite3_bind_blob', 'sqlite3_bind_blob64', 'sqlite3_bind_double', 'sqlite3_bind_int', 'sqlite3_bind_int64', 'sqlite3_bind_null', 'sqlite3_bind_parameter_count', 'sqlite3_bind_parameter_index', 'sqlite3_bind_parameter_name', 'sqlite3_bind_pointer', 'sqlite3_bind_text', 'sqlite3_bind_text16', 'sqlite3_bind_text64', 'sqlite3_bind_value', 'sqlite3_bind_zeroblob', 'sqlite3_bind_zeroblob64', 'sqlite3_blob_bytes', 'sqlite3_blob_close', 'sqlite3_blob_open', 'sqlite3_blob_read', 'sqlite3_blob_reopen', 'sqlite3_blob_write', 'sqlite3_busy_handler', 'sqlite3_busy_timeout', 'sqlite3_cancel_auto_extension', 'sqlite3_changes', 'sqlite3_clear_bindings', 'sqlite3_close', 'sqlite3_close_v2', 'sqlite3_collation_needed', 'sqlite3_collation_needed16', 'sqlite3_column_blob', 'sqlite3_column_bytes', 'sqlite3_column_bytes16', 'sqlite3_column_count', 'sqlite3_column_database_name', 'sqlite3_column_database_name16', 'sqlite3_column_decltype', 'sqlite3_column_decltype16', 'sqlite3_column_double', 'sqlite3_column_int', 'sqlite3_column_int64', 'sqlite3_column_name', 'sqlite3_column_name16', 'sqlite3_column_origin_name', 'sqlite3_column_origin_name16', 'sqlite3_column_table_name', 'sqlite3_column_table_name16', 'sqlite3_column_text', 'sqlite3_column_text16', 'sqlite3_column_type', 'sqlite3_column_value', 'sqlite3_commit_hook', 'sqlite3_compileoption_get', 'sqlite3_compileoption_used', 'sqlite3_complete', 'sqlite3_complete16', 'sqlite3_config', 'sqlite3_context_db_handle', 'sqlite3_create_collation', 'sqlite3_create_collation16', 'sqlite3_create_collation_v2', 'sqlite3_create_function', 'sqlite3_create_function16', 'sqlite3_create_function_v2', 'sqlite3_create_module', 'sqlite3_create_module_v2', 'sqlite3_create_window_function', 'sqlite3_data_count', 'sqlite3_data_directory', 'sqlite3_db_cacheflush', 'sqlite3_db_config', 'sqlite3_db_filename', 'sqlite3_db_handle', 'sqlite3_db_mutex', 'sqlite3_db_readonly', 'sqlite3_db_release_memory', 'sqlite3_db_status', 'sqlite3_declare_vtab', 'sqlite3_enable_load_extension', 'sqlite3_enable_shared_cache', 'sqlite3_errcode', 'sqlite3_errmsg', 'sqlite3_errmsg16', 'sqlite3_errstr', 'sqlite3_exec', 'sqlite3_expanded_sql', 'sqlite3_expired', 'sqlite3_extended_errcode', 'sqlite3_extended_result_codes', 'sqlite3_file_control', 'sqlite3_finalize', 'sqlite3_free', 'sqlite3_free_table', 'sqlite3_get_autocommit', 'sqlite3_get_auxdata', 'sqlite3_get_table', 'sqlite3_global_recover', 'sqlite3_initialize', 'sqlite3_interrupt', 'sqlite3_keyword_check', 'sqlite3_keyword_count', 'sqlite3_keyword_name', 'sqlite3_last_insert_rowid', 'sqlite3_libversion', 'sqlite3_libversion_number', 'sqlite3_limit', 'sqlite3_load_extension', 'sqlite3_log', 'sqlite3_malloc', 'sqlite3_malloc64', 'sqlite3_memory_alarm', 'sqlite3_memory_highwater', 'sqlite3_memory_used', 'sqlite3_mprintf', 'sqlite3_msize', 'sqlite3_mutex_alloc', 'sqlite3_mutex_enter', 'sqlite3_mutex_free', 'sqlite3_mutex_leave', 'sqlite3_mutex_try', 'sqlite3_next_stmt', 'sqlite3_open', 'sqlite3_open16', 'sqlite3_open_v2', 'sqlite3_os_end', 'sqlite3_os_init', 'sqlite3_overload_function', 'sqlite3_prepare', 'sqlite3_prepare16', 'sqlite3_prepare16_v2', 'sqlite3_prepare16_v3', 'sqlite3_prepare_v2', 'sqlite3_prepare_v3', 'sqlite3_profile', 'sqlite3_progress_handler', 'sqlite3_randomness', 'sqlite3_realloc', 'sqlite3_realloc64', 'sqlite3_release_memory', 'sqlite3_reset', 'sqlite3_reset_auto_extension', 'sqlite3_result_blob', 'sqlite3_result_blob64', 'sqlite3_result_double', 'sqlite3_result_error', 'sqlite3_result_error16', 'sqlite3_result_error_code', 'sqlite3_result_error_nomem', 'sqlite3_result_error_toobig', 'sqlite3_result_int', 'sqlite3_result_int64', 'sqlite3_result_null', 'sqlite3_result_pointer', 'sqlite3_result_subtype', 'sqlite3_result_text', 'sqlite3_result_text16', 'sqlite3_result_text16be', 'sqlite3_result_text16le', 'sqlite3_result_text64', 'sqlite3_result_value', 'sqlite3_result_zeroblob', 'sqlite3_result_zeroblob64', 'sqlite3_rollback_hook', 'sqlite3_rtree_geometry_callback', 'sqlite3_rtree_query_callback', 'sqlite3_set_authorizer', 'sqlite3_set_auxdata', 'sqlite3_set_last_insert_rowid', 'sqlite3_shutdown', 'sqlite3_sleep', 'sqlite3_snprintf', 'sqlite3_soft_heap_limit', 'sqlite3_soft_heap_limit64', 'sqlite3_sourceid', 'sqlite3_sql', 'sqlite3_status', 'sqlite3_status64', 'sqlite3_step', 'sqlite3_stmt_busy', 'sqlite3_stmt_isexplain', 'sqlite3_stmt_readonly', 'sqlite3_stmt_status', 'sqlite3_str_append', 'sqlite3_str_appendall', 'sqlite3_str_appendchar', 'sqlite3_str_appendf', 'sqlite3_str_errcode', 'sqlite3_str_finish', 'sqlite3_str_length', 'sqlite3_str_new', 'sqlite3_str_reset', 'sqlite3_str_value', 'sqlite3_str_vappendf', 'sqlite3_strglob', 'sqlite3_stricmp', 'sqlite3_strlike', 'sqlite3_strnicmp', 'sqlite3_system_errno', 'sqlite3_table_column_metadata', 'sqlite3_temp_directory', 'sqlite3_test_control', 'sqlite3_thread_cleanup', 'sqlite3_threadsafe', 'sqlite3_total_changes', 'sqlite3_trace', 'sqlite3_trace_v2', 'sqlite3_transfer_bindings', 'sqlite3_update_hook', 'sqlite3_uri_boolean', 'sqlite3_uri_int64', 'sqlite3_uri_parameter', 'sqlite3_user_data', 'sqlite3_value_blob', 'sqlite3_value_bytes', 'sqlite3_value_bytes16', 'sqlite3_value_double', 'sqlite3_value_dup', 'sqlite3_value_free', 'sqlite3_value_frombind', 'sqlite3_value_int', 'sqlite3_value_int64', 'sqlite3_value_nochange', 'sqlite3_value_numeric_type', 'sqlite3_value_pointer', 'sqlite3_value_subtype', 'sqlite3_value_text', 'sqlite3_value_text16', 'sqlite3_value_text16be', 'sqlite3_value_text16le', 'sqlite3_value_type', 'sqlite3_version', 'sqlite3_vfs_find', 'sqlite3_vfs_register', 'sqlite3_vfs_unregister', 'sqlite3_vmprintf', 'sqlite3_vsnprintf', 'sqlite3_vtab_collation', 'sqlite3_vtab_config', 'sqlite3_vtab_nochange', 'sqlite3_vtab_on_conflict', 'sqlite3_wal_autocheckpoint', 'sqlite3_wal_checkpoint', 'sqlite3_wal_checkpoint_v2', 'sqlite3_wal_hook', 'sqlite3_win32_is_nt', 'sqlite3_win32_mbcs_to_utf8', 'sqlite3_win32_mbcs_to_utf8_v2', 'sqlite3_win32_set_directory', 'sqlite3_win32_set_directory16', 'sqlite3_win32_set_directory8', 'sqlite3_win32_sleep', 'sqlite3_win32_unicode_to_utf8', 'sqlite3_win32_utf8_to_mbcs', 'sqlite3_win32_utf8_to_mbcs_v2', 'sqlite3_win32_utf8_to_unicode', 'sqlite3_win32_write_debug' ]
# advapi32.dll APIs
api_list_advapi32 = [ 'A_SHAFinal', 'A_SHAInit', 'A_SHAUpdate', 'AbortSystemShutdownA', 'AbortSystemShutdownW', 'AccessCheck', 'AccessCheckAndAuditAlarmA', 'AccessCheckAndAuditAlarmW', 'AccessCheckByType', 'AccessCheckByTypeAndAuditAlarmA', 'AccessCheckByTypeAndAuditAlarmW', 'AccessCheckByTypeResultList', 'AccessCheckByTypeResultListAndAuditAlarmA', 'AccessCheckByTypeResultListAndAuditAlarmByHandleA', 'AccessCheckByTypeResultListAndAuditAlarmByHandleW', 'AccessCheckByTypeResultListAndAuditAlarmW', 'AddAccessAllowedAce', 'AddAccessAllowedAceEx', 'AddAccessAllowedObjectAce', 'AddAccessDeniedAce', 'AddAccessDeniedAceEx', 'AddAccessDeniedObjectAce', 'AddAce', 'AddAuditAccessAce', 'AddAuditAccessAceEx', 'AddAuditAccessObjectAce', 'AddConditionalAce', 'AddMandatoryAce', 'AddUsersToEncryptedFile', 'AddUsersToEncryptedFileEx', 'AdjustTokenGroups', 'AdjustTokenPrivileges', 'AllocateAndInitializeSid', 'AllocateLocallyUniqueId', 'AreAllAccessesGranted', 'AreAnyAccessesGranted', 'AuditComputeEffectivePolicyBySid', 'AuditComputeEffectivePolicyByToken', 'AuditEnumerateCategories', 'AuditEnumeratePerUserPolicy', 'AuditEnumerateSubCategories', 'AuditFree', 'AuditLookupCategoryGuidFromCategoryId', 'AuditLookupCategoryIdFromCategoryGuid', 'AuditLookupCategoryNameA', 'AuditLookupCategoryNameW', 'AuditLookupSubCategoryNameA', 'AuditLookupSubCategoryNameW', 'AuditQueryGlobalSaclA', 'AuditQueryGlobalSaclW', 'AuditQueryPerUserPolicy', 'AuditQuerySecurity', 'AuditQuerySystemPolicy', 'AuditSetGlobalSaclA', 'AuditSetGlobalSaclW', 'AuditSetPerUserPolicy', 'AuditSetSecurity', 'AuditSetSystemPolicy', 'BackupEventLogA', 'BackupEventLogW', 'BaseRegCloseKey', 'BaseRegCreateKey', 'BaseRegDeleteKeyEx', 'BaseRegDeleteValue', 'BaseRegFlushKey', 'BaseRegGetVersion', 'BaseRegLoadKey', 'BaseRegOpenKey', 'BaseRegRestoreKey', 'BaseRegSaveKeyEx', 'BaseRegSetKeySecurity', 'BaseRegSetValue', 'BaseRegUnLoadKey', 'BuildExplicitAccessWithNameA', 'BuildExplicitAccessWithNameW', 'BuildImpersonateExplicitAccessWithNameA', 'BuildImpersonateExplicitAccessWithNameW', 'BuildImpersonateTrusteeA', 'BuildImpersonateTrusteeW', 'BuildSecurityDescriptorA', 'BuildSecurityDescriptorW', 'BuildTrusteeWithNameA', 'BuildTrusteeWithNameW', 'BuildTrusteeWithObjectsAndNameA', 'BuildTrusteeWithObjectsAndNameW', 'BuildTrusteeWithObjectsAndSidA', 'BuildTrusteeWithObjectsAndSidW', 'BuildTrusteeWithSidA', 'BuildTrusteeWithSidW', 'CancelOverlappedAccess', 'ChangeServiceConfig2A', 'ChangeServiceConfig2W', 'ChangeServiceConfigA', 'ChangeServiceConfigW', 'CheckForHiberboot', 'CheckTokenMembership', 'ClearEventLogA', 'ClearEventLogW', 'CloseCodeAuthzLevel', 'CloseEncryptedFileRaw', 'CloseEventLog', 'CloseServiceHandle', 'CloseThreadWaitChainSession', 'CloseTrace', 'CommandLineFromMsiDescriptor', 'ComputeAccessTokenFromCodeAuthzLevel', 'ControlService', 'ControlServiceExA', 'ControlServiceExW', 'ControlTraceA', 'ControlTraceW', 'ConvertAccessToSecurityDescriptorA', 'ConvertAccessToSecurityDescriptorW', 'ConvertSDToStringSDDomainW', 'ConvertSDToStringSDRootDomainA', 'ConvertSDToStringSDRootDomainW', 'ConvertSecurityDescriptorToAccessA', 'ConvertSecurityDescriptorToAccessNamedA', 'ConvertSecurityDescriptorToAccessNamedW', 'ConvertSecurityDescriptorToAccessW', 'ConvertSecurityDescriptorToStringSecurityDescriptorA', 'ConvertSecurityDescriptorToStringSecurityDescriptorW', 'ConvertSidToStringSidA', 'ConvertSidToStringSidW', 'ConvertStringSDToSDDomainA', 'ConvertStringSDToSDDomainW', 'ConvertStringSDToSDRootDomainA', 'ConvertStringSDToSDRootDomainW', 'ConvertStringSecurityDescriptorToSecurityDescriptorA', 'ConvertStringSecurityDescriptorToSecurityDescriptorW', 'ConvertStringSidToSidA', 'ConvertStringSidToSidW', 'ConvertToAutoInheritPrivateObjectSecurity', 'CopySid', 'CreateCodeAuthzLevel', 'CreatePrivateObjectSecurity', 'CreatePrivateObjectSecurityEx', 'CreatePrivateObjectSecurityWithMultipleInheritance', 'CreateProcessAsUserA', 'CreateProcessAsUserW', 'CreateProcessWithLogonW', 'CreateProcessWithTokenW', 'CreateRestrictedToken', 'CreateServiceA', 'CreateServiceEx', 'CreateServiceW', 'CreateTraceInstanceId', 'CreateWellKnownSid', 'CredBackupCredentials', 'CredDeleteA', 'CredDeleteW', 'CredEncryptAndMarshalBinaryBlob', 'CredEnumerateA', 'CredEnumerateW', 'CredFindBestCredentialA', 'CredFindBestCredentialW', 'CredFree', 'CredGetSessionTypes', 'CredGetTargetInfoA', 'CredGetTargetInfoW', 'CredIsMarshaledCredentialA', 'CredIsMarshaledCredentialW', 'CredIsProtectedA', 'CredIsProtectedW', 'CredMarshalCredentialA', 'CredMarshalCredentialW', 'CredProfileLoaded', 'CredProfileLoadedEx', 'CredProfileUnloaded', 'CredProtectA', 'CredProtectW', 'CredReadA', 'CredReadByTokenHandle', 'CredReadDomainCredentialsA', 'CredReadDomainCredentialsW', 'CredReadW', 'CredRenameA', 'CredRenameW', 'CredRestoreCredentials', 'CredUnmarshalCredentialA', 'CredUnmarshalCredentialW', 'CredUnprotectA', 'CredUnprotectW', 'CredWriteA', 'CredWriteDomainCredentialsA', 'CredWriteDomainCredentialsW', 'CredWriteW', 'CredpConvertCredential', 'CredpConvertOneCredentialSize', 'CredpConvertTargetInfo', 'CredpDecodeCredential', 'CredpEncodeCredential', 'CredpEncodeSecret', 'CryptAcquireContextA', 'CryptAcquireContextW', 'CryptContextAddRef', 'CryptCreateHash', 'CryptDecrypt', 'CryptDeriveKey', 'CryptDestroyHash', 'CryptDestroyKey', 'CryptDuplicateHash', 'CryptDuplicateKey', 'CryptEncrypt', 'CryptEnumProviderTypesA', 'CryptEnumProviderTypesW', 'CryptEnumProvidersA', 'CryptEnumProvidersW', 'CryptExportKey', 'CryptGenKey', 'CryptGenRandom', 'CryptGetDefaultProviderA', 'CryptGetDefaultProviderW', 'CryptGetHashParam', 'CryptGetKeyParam', 'CryptGetProvParam', 'CryptGetUserKey', 'CryptHashData', 'CryptHashSessionKey', 'CryptImportKey', 'CryptReleaseContext', 'CryptSetHashParam', 'CryptSetKeyParam', 'CryptSetProvParam', 'CryptSetProviderA', 'CryptSetProviderExA', 'CryptSetProviderExW', 'CryptSetProviderW', 'CryptSignHashA', 'CryptSignHashW', 'CryptVerifySignatureA', 'CryptVerifySignatureW', 'CveEventWrite', 'DecryptFileA', 'DecryptFileW', 'DeleteAce', 'DeleteService', 'DeregisterEventSource', 'DestroyPrivateObjectSecurity', 'DuplicateEncryptionInfoFile', 'DuplicateToken', 'DuplicateTokenEx', 'ElfBackupEventLogFileA', 'ElfBackupEventLogFileW', 'ElfChangeNotify', 'ElfClearEventLogFileA', 'ElfClearEventLogFileW', 'ElfCloseEventLog', 'ElfDeregisterEventSource', 'ElfFlushEventLog', 'ElfNumberOfRecords', 'ElfOldestRecord', 'ElfOpenBackupEventLogA', 'ElfOpenBackupEventLogW', 'ElfOpenEventLogA', 'ElfOpenEventLogW', 'ElfReadEventLogA', 'ElfReadEventLogW', 'ElfRegisterEventSourceA', 'ElfRegisterEventSourceW', 'ElfReportEventA', 'ElfReportEventAndSourceW', 'ElfReportEventW', 'EnableTrace', 'EnableTraceEx', 'EnableTraceEx2', 'EncryptFileA', 'EncryptFileW', 'EncryptedFileKeyInfo', 'EncryptionDisable', 'EnumDependentServicesA', 'EnumDependentServicesW', 'EnumDynamicTimeZoneInformation', 'EnumServiceGroupW', 'EnumServicesStatusA', 'EnumServicesStatusExA', 'EnumServicesStatusExW', 'EnumServicesStatusW', 'EnumerateTraceGuids', 'EnumerateTraceGuidsEx', 'EqualDomainSid', 'EqualPrefixSid', 'EqualSid', 'EventAccessControl', 'EventAccessQuery', 'EventAccessRemove', 'EventActivityIdControl', 'EventEnabled', 'EventProviderEnabled', 'EventRegister', 'EventSetInformation', 'EventUnregister', 'EventWrite', 'EventWriteEndScenario', 'EventWriteEx', 'EventWriteStartScenario', 'EventWriteString', 'EventWriteTransfer', 'FileEncryptionStatusA', 'FileEncryptionStatusW', 'FindFirstFreeAce', 'FlushEfsCache', 'FlushTraceA', 'FlushTraceW', 'FreeEncryptedFileKeyInfo', 'FreeEncryptedFileMetadata', 'FreeEncryptionCertificateHashList', 'FreeInheritedFromArray', 'FreeSid', 'GetAccessPermissionsForObjectA', 'GetAccessPermissionsForObjectW', 'GetAce', 'GetAclInformation', 'GetAuditedPermissionsFromAclA', 'GetAuditedPermissionsFromAclW', 'GetCurrentHwProfileA', 'GetCurrentHwProfileW', 'GetDynamicTimeZoneInformationEffectiveYears', 'GetEffectiveRightsFromAclA', 'GetEffectiveRightsFromAclW', 'GetEncryptedFileMetadata', 'GetEventLogInformation', 'GetExplicitEntriesFromAclA', 'GetExplicitEntriesFromAclW', 'GetFileSecurityA', 'GetFileSecurityW', 'GetInformationCodeAuthzLevelW', 'GetInformationCodeAuthzPolicyW', 'GetInheritanceSourceA', 'GetInheritanceSourceW', 'GetKernelObjectSecurity', 'GetLengthSid', 'GetLocalManagedApplicationData', 'GetLocalManagedApplications', 'GetManagedApplicationCategories', 'GetManagedApplications', 'GetMultipleTrusteeA', 'GetMultipleTrusteeOperationA', 'GetMultipleTrusteeOperationW', 'GetMultipleTrusteeW', 'GetNamedSecurityInfoA', 'GetNamedSecurityInfoExA', 'GetNamedSecurityInfoExW', 'GetNamedSecurityInfoW', 'GetNumberOfEventLogRecords', 'GetOldestEventLogRecord', 'GetOverlappedAccessResults', 'GetPrivateObjectSecurity', 'GetSecurityDescriptorControl', 'GetSecurityDescriptorDacl', 'GetSecurityDescriptorGroup', 'GetSecurityDescriptorLength', 'GetSecurityDescriptorOwner', 'GetSecurityDescriptorRMControl', 'GetSecurityDescriptorSacl', 'GetSecurityInfo', 'GetSecurityInfoExA', 'GetSecurityInfoExW', 'GetServiceDisplayNameA', 'GetServiceDisplayNameW', 'GetServiceKeyNameA', 'GetServiceKeyNameW', 'GetSidIdentifierAuthority', 'GetSidLengthRequired', 'GetSidSubAuthority', 'GetSidSubAuthorityCount', 'GetStringConditionFromBinary', 'GetThreadWaitChain', 'GetTokenInformation', 'GetTraceEnableFlags', 'GetTraceEnableLevel', 'GetTraceLoggerHandle', 'GetTrusteeFormA', 'GetTrusteeFormW', 'GetTrusteeNameA', 'GetTrusteeNameW', 'GetTrusteeTypeA', 'GetTrusteeTypeW', 'GetUserNameA', 'GetUserNameW', 'GetWindowsAccountDomainSid', 'I_QueryTagInformation', 'I_ScGetCurrentGroupStateW', 'I_ScIsSecurityProcess', 'I_ScPnPGetServiceName', 'I_ScQueryServiceConfig', 'I_ScRegisterPreshutdownRestart', 'I_ScReparseServiceDatabase', 'I_ScSendPnPMessage', 'I_ScSendTSMessage', 'I_ScSetServiceBitsA', 'I_ScSetServiceBitsW', 'I_ScValidatePnPService', 'IdentifyCodeAuthzLevelW', 'ImpersonateAnonymousToken', 'ImpersonateLoggedOnUser', 'ImpersonateNamedPipeClient', 'ImpersonateSelf', 'InitializeAcl', 'InitializeSecurityDescriptor', 'InitializeSid', 'InitiateShutdownA', 'InitiateShutdownW', 'InitiateSystemShutdownA', 'InitiateSystemShutdownExA', 'InitiateSystemShutdownExW', 'InitiateSystemShutdownW', 'InstallApplication', 'IsTextUnicode', 'IsTokenRestricted', 'IsTokenUntrusted', 'IsValidAcl', 'IsValidRelativeSecurityDescriptor', 'IsValidSecurityDescriptor', 'IsValidSid', 'IsWellKnownSid', 'LockServiceDatabase', 'LogonUserA', 'LogonUserExA', 'LogonUserExExW', 'LogonUserExW', 'LogonUserW', 'LookupAccountNameA', 'LookupAccountNameW', 'LookupAccountSidA', 'LookupAccountSidW', 'LookupPrivilegeDisplayNameA', 'LookupPrivilegeDisplayNameW', 'LookupPrivilegeNameA', 'LookupPrivilegeNameW', 'LookupPrivilegeValueA', 'LookupPrivilegeValueW', 'LookupSecurityDescriptorPartsA', 'LookupSecurityDescriptorPartsW', 'LsaAddAccountRights', 'LsaAddPrivilegesToAccount', 'LsaClearAuditLog', 'LsaClose', 'LsaCreateAccount', 'LsaCreateSecret', 'LsaCreateTrustedDomain', 'LsaCreateTrustedDomainEx', 'LsaDelete', 'LsaDeleteTrustedDomain', 'LsaEnumerateAccountRights', 'LsaEnumerateAccounts', 'LsaEnumerateAccountsWithUserRight', 'LsaEnumeratePrivileges', 'LsaEnumeratePrivilegesOfAccount', 'LsaEnumerateTrustedDomains', 'LsaEnumerateTrustedDomainsEx', 'LsaFreeMemory', 'LsaGetAppliedCAPIDs', 'LsaGetQuotasForAccount', 'LsaGetRemoteUserName', 'LsaGetSystemAccessAccount', 'LsaGetUserName', 'LsaICLookupNames', 'LsaICLookupNamesWithCreds', 'LsaICLookupSids', 'LsaICLookupSidsWithCreds', 'LsaInvokeTrustScanner', 'LsaLookupNames', 'LsaLookupNames2', 'LsaLookupPrivilegeDisplayName', 'LsaLookupPrivilegeName', 'LsaLookupPrivilegeValue', 'LsaLookupSids', 'LsaLookupSids2', 'LsaManageSidNameMapping', 'LsaNtStatusToWinError', 'LsaOpenAccount', 'LsaOpenPolicy', 'LsaOpenPolicySce', 'LsaOpenSecret', 'LsaOpenTrustedDomain', 'LsaOpenTrustedDomainByName', 'LsaQueryCAPs', 'LsaQueryDomainInformationPolicy', 'LsaQueryForestTrustInformation', 'LsaQueryForestTrustInformation2', 'LsaQueryInfoTrustedDomain', 'LsaQueryInformationPolicy', 'LsaQuerySecret', 'LsaQuerySecurityObject', 'LsaQueryTrustedDomainInfo', 'LsaQueryTrustedDomainInfoByName', 'LsaRemoveAccountRights', 'LsaRemovePrivilegesFromAccount', 'LsaRetrievePrivateData', 'LsaSetCAPs', 'LsaSetDomainInformationPolicy', 'LsaSetForestTrustInformation', 'LsaSetForestTrustInformation2', 'LsaSetInformationPolicy', 'LsaSetInformationTrustedDomain', 'LsaSetQuotasForAccount', 'LsaSetSecret', 'LsaSetSecurityObject', 'LsaSetSystemAccessAccount', 'LsaSetTrustedDomainInfoByName', 'LsaSetTrustedDomainInformation', 'LsaStorePrivateData', 'MD4Final', 'MD4Init', 'MD4Update', 'MD5Final', 'MD5Init', 'MD5Update', 'MIDL_user_free_Ext', 'MSChapSrvChangePassword', 'MSChapSrvChangePassword2', 'MakeAbsoluteSD', 'MakeAbsoluteSD2', 'MakeSelfRelativeSD', 'MapGenericMask', 'NotifyBootConfigStatus', 'NotifyChangeEventLog', 'NotifyServiceStatusChange', 'NotifyServiceStatusChangeA', 'NotifyServiceStatusChangeW', 'NpGetUserName', 'ObjectCloseAuditAlarmA', 'ObjectCloseAuditAlarmW', 'ObjectDeleteAuditAlarmA', 'ObjectDeleteAuditAlarmW', 'ObjectOpenAuditAlarmA', 'ObjectOpenAuditAlarmW', 'ObjectPrivilegeAuditAlarmA', 'ObjectPrivilegeAuditAlarmW', 'OpenBackupEventLogA', 'OpenBackupEventLogW', 'OpenEncryptedFileRawA', 'OpenEncryptedFileRawW', 'OpenEventLogA', 'OpenEventLogW', 'OpenProcessToken', 'OpenSCManagerA', 'OpenSCManagerW', 'OpenServiceA', 'OpenServiceW', 'OpenThreadToken', 'OpenThreadWaitChainSession', 'OpenTraceA', 'OpenTraceW', 'OperationEnd', 'OperationStart', 'PerfAddCounters', 'PerfCloseQueryHandle', 'PerfCreateInstance', 'PerfDecrementULongCounterValue', 'PerfDecrementULongLongCounterValue', 'PerfDeleteCounters', 'PerfDeleteInstance', 'PerfEnumerateCounterSet', 'PerfEnumerateCounterSetInstances', 'PerfIncrementULongCounterValue', 'PerfIncrementULongLongCounterValue', 'PerfOpenQueryHandle', 'PerfQueryCounterData', 'PerfQueryCounterInfo', 'PerfQueryCounterSetRegistrationInfo', 'PerfQueryInstance', 'PerfRegCloseKey', 'PerfRegEnumKey', 'PerfRegEnumValue', 'PerfRegQueryInfoKey', 'PerfRegQueryValue', 'PerfRegSetValue', 'PerfSetCounterRefValue', 'PerfSetCounterSetInfo', 'PerfSetULongCounterValue', 'PerfSetULongLongCounterValue', 'PerfStartProvider', 'PerfStartProviderEx', 'PerfStopProvider', 'PrivilegeCheck', 'PrivilegedServiceAuditAlarmA', 'PrivilegedServiceAuditAlarmW', 'ProcessIdleTasks', 'ProcessIdleTasksW', 'ProcessTrace', 'QueryAllTracesA', 'QueryAllTracesW', 'QueryLocalUserServiceName', 'QueryRecoveryAgentsOnEncryptedFile', 'QuerySecurityAccessMask', 'QueryServiceConfig2A', 'QueryServiceConfig2W', 'QueryServiceConfigA', 'QueryServiceConfigW', 'QueryServiceDynamicInformation', 'QueryServiceLockStatusA', 'QueryServiceLockStatusW', 'QueryServiceObjectSecurity', 'QueryServiceStatus', 'QueryServiceStatusEx', 'QueryTraceA', 'QueryTraceProcessingHandle', 'QueryTraceW', 'QueryUserServiceName', 'QueryUserServiceNameForContext', 'QueryUsersOnEncryptedFile', 'ReadEncryptedFileRaw', 'ReadEventLogA', 'ReadEventLogW', 'RegCloseKey', 'RegConnectRegistryA', 'RegConnectRegistryExA', 'RegConnectRegistryExW', 'RegConnectRegistryW', 'RegCopyTreeA', 'RegCopyTreeW', 'RegCreateKeyA', 'RegCreateKeyExA', 'RegCreateKeyExW', 'RegCreateKeyTransactedA', 'RegCreateKeyTransactedW', 'RegCreateKeyW', 'RegDeleteKeyA', 'RegDeleteKeyExA', 'RegDeleteKeyExW', 'RegDeleteKeyTransactedA', 'RegDeleteKeyTransactedW', 'RegDeleteKeyValueA', 'RegDeleteKeyValueW', 'RegDeleteKeyW', 'RegDeleteTreeA', 'RegDeleteTreeW', 'RegDeleteValueA', 'RegDeleteValueW', 'RegDisablePredefinedCache', 'RegDisablePredefinedCacheEx', 'RegDisableReflectionKey', 'RegEnableReflectionKey', 'RegEnumKeyA', 'RegEnumKeyExA', 'RegEnumKeyExW', 'RegEnumKeyW', 'RegEnumValueA', 'RegEnumValueW', 'RegFlushKey', 'RegGetKeySecurity', 'RegGetValueA', 'RegGetValueW', 'RegLoadAppKeyA', 'RegLoadAppKeyW', 'RegLoadKeyA', 'RegLoadKeyW', 'RegLoadMUIStringA', 'RegLoadMUIStringW', 'RegNotifyChangeKeyValue', 'RegOpenCurrentUser', 'RegOpenKeyA', 'RegOpenKeyExA', 'RegOpenKeyExW', 'RegOpenKeyTransactedA', 'RegOpenKeyTransactedW', 'RegOpenKeyW', 'RegOpenUserClassesRoot', 'RegOverridePredefKey', 'RegQueryInfoKeyA', 'RegQueryInfoKeyW', 'RegQueryMultipleValuesA', 'RegQueryMultipleValuesW', 'RegQueryReflectionKey', 'RegQueryValueA', 'RegQueryValueExA', 'RegQueryValueExW', 'RegQueryValueW', 'RegRenameKey', 'RegReplaceKeyA', 'RegReplaceKeyW', 'RegRestoreKeyA', 'RegRestoreKeyW', 'RegSaveKeyA', 'RegSaveKeyExA', 'RegSaveKeyExW', 'RegSaveKeyW', 'RegSetKeySecurity', 'RegSetKeyValueA', 'RegSetKeyValueW', 'RegSetValueA', 'RegSetValueExA', 'RegSetValueExW', 'RegSetValueW', 'RegUnLoadKeyA', 'RegUnLoadKeyW', 'RegisterEventSourceA', 'RegisterEventSourceW', 'RegisterIdleTask', 'RegisterServiceCtrlHandlerA', 'RegisterServiceCtrlHandlerExA', 'RegisterServiceCtrlHandlerExW', 'RegisterServiceCtrlHandlerW', 'RegisterTraceGuidsA', 'RegisterTraceGuidsW', 'RegisterWaitChainCOMCallback', 'RemoteRegEnumKeyWrapper', 'RemoteRegEnumValueWrapper', 'RemoteRegQueryInfoKeyWrapper', 'RemoteRegQueryMultipleValues2Wrapper', 'RemoteRegQueryMultipleValuesWrapper', 'RemoteRegQueryValueWrapper', 'RemoveTraceCallback', 'RemoveUsersFromEncryptedFile', 'ReportEventA', 'ReportEventW', 'RevertToSelf', 'SafeBaseRegGetKeySecurity', 'SaferCloseLevel', 'SaferComputeTokenFromLevel', 'SaferCreateLevel', 'SaferGetLevelInformation', 'SaferGetPolicyInformation', 'SaferIdentifyLevel', 'SaferRecordEventLogEntry', 'SaferSetLevelInformation', 'SaferSetPolicyInformation', 'SaferiChangeRegistryScope', 'SaferiCompareTokenLevels', 'SaferiIsDllAllowed', 'SaferiIsExecutableFileType', 'SaferiPopulateDefaultsInRegistry', 'SaferiRecordEventLogEntry', 'SaferiSearchMatchingHashRules', 'SetAclInformation', 'SetEncryptedFileMetadata', 'SetEntriesInAccessListA', 'SetEntriesInAccessListW', 'SetEntriesInAclA', 'SetEntriesInAclW', 'SetEntriesInAuditListA', 'SetEntriesInAuditListW', 'SetFileSecurityA', 'SetFileSecurityW', 'SetInformationCodeAuthzLevelW', 'SetInformationCodeAuthzPolicyW', 'SetKernelObjectSecurity', 'SetNamedSecurityInfoA', 'SetNamedSecurityInfoExA', 'SetNamedSecurityInfoExW', 'SetNamedSecurityInfoW', 'SetPrivateObjectSecurity', 'SetPrivateObjectSecurityEx', 'SetSecurityAccessMask', 'SetSecurityDescriptorControl', 'SetSecurityDescriptorDacl', 'SetSecurityDescriptorGroup', 'SetSecurityDescriptorOwner', 'SetSecurityDescriptorRMControl', 'SetSecurityDescriptorSacl', 'SetSecurityInfo', 'SetSecurityInfoExA', 'SetSecurityInfoExW', 'SetServiceBits', 'SetServiceObjectSecurity', 'SetServiceStatus', 'SetThreadToken', 'SetTokenInformation', 'SetTraceCallback', 'SetUserFileEncryptionKey', 'SetUserFileEncryptionKeyEx', 'StartServiceA', 'StartServiceCtrlDispatcherA', 'StartServiceCtrlDispatcherW', 'StartServiceW', 'StartTraceA', 'StartTraceW', 'StopTraceA', 'StopTraceW', 'SystemFunction001', 'SystemFunction002', 'SystemFunction003', 'SystemFunction004', 'SystemFunction005', 'SystemFunction006', 'SystemFunction007', 'SystemFunction008', 'SystemFunction009', 'SystemFunction010', 'SystemFunction011', 'SystemFunction012', 'SystemFunction013', 'SystemFunction014', 'SystemFunction015', 'SystemFunction016', 'SystemFunction017', 'SystemFunction018', 'SystemFunction019', 'SystemFunction020', 'SystemFunction021', 'SystemFunction022', 'SystemFunction023', 'SystemFunction024', 'SystemFunction025', 'SystemFunction026', 'SystemFunction027', 'SystemFunction028', 'SystemFunction029', 'SystemFunction030', 'SystemFunction031', 'SystemFunction032', 'SystemFunction033', 'SystemFunction034', 'SystemFunction035', 'SystemFunction036', 'SystemFunction040', 'SystemFunction041', 'TraceEvent', 'TraceEventInstance', 'TraceMessage', 'TraceMessageVa', 'TraceQueryInformation', 'TraceSetInformation', 'TreeResetNamedSecurityInfoA', 'TreeResetNamedSecurityInfoW', 'TreeSetNamedSecurityInfoA', 'TreeSetNamedSecurityInfoW', 'TrusteeAccessToObjectA', 'TrusteeAccessToObjectW', 'UninstallApplication', 'UnlockServiceDatabase', 'UnregisterIdleTask', 'UnregisterTraceGuids', 'UpdateTraceA', 'UpdateTraceW', 'UsePinForEncryptedFilesA', 'UsePinForEncryptedFilesW', 'WaitServiceState', 'WmiCloseBlock', 'WmiDevInstToInstanceNameA', 'WmiDevInstToInstanceNameW', 'WmiEnumerateGuids', 'WmiExecuteMethodA', 'WmiExecuteMethodW', 'WmiFileHandleToInstanceNameA', 'WmiFileHandleToInstanceNameW', 'WmiFreeBuffer', 'WmiMofEnumerateResourcesA', 'WmiMofEnumerateResourcesW', 'WmiNotificationRegistrationA', 'WmiNotificationRegistrationW', 'WmiOpenBlock', 'WmiQueryAllDataA', 'WmiQueryAllDataMultipleA', 'WmiQueryAllDataMultipleW', 'WmiQueryAllDataW', 'WmiQueryGuidInformation', 'WmiQuerySingleInstanceA', 'WmiQuerySingleInstanceMultipleA', 'WmiQuerySingleInstanceMultipleW', 'WmiQuerySingleInstanceW', 'WmiReceiveNotificationsA', 'WmiReceiveNotificationsW', 'WmiSetSingleInstanceA', 'WmiSetSingleInstanceW', 'WmiSetSingleItemA', 'WmiSetSingleItemW', 'WriteEncryptedFileRaw' ]

# Based on https://github.com/Orochimarufan/cdev/blob/master/cdev/murmurhash2.py
# but converted to Jython / Python2 for Ghidra and using Lumma's seed 0x20 as default
def calc_hash(input, seed=0x20):
    l = len(input)
    m = 0x5bd1e995
    h = seed ^ l

    x = l % 4
    o = l - x
    input_bytes = bytearray(input)

    for i in range(0, o, 4):
        k = (input_bytes[i + 3] << 24) | (input_bytes[i + 2] << 16) | (input_bytes[i + 1] << 8) | input_bytes[i]
        k = (k * m) & 0xFFFFFFFF
        h = (((k ^ (k >> 24)) * m) ^ (h * m)) & 0xFFFFFFFF

    if x > 0:
        if x > 2:
            h ^= input_bytes[o + 2] << 16
        if x > 1:
            h ^= input_bytes[o + 1] << 8
        h = ((h ^ input_bytes[o]) * m) & 0xFFFFFFFF

    h = ((h ^ (h >> 13)) * m) & 0xFFFFFFFF
    return (h ^ (h >> 15)) & 0xFFFFFFFF

def find_api_for_hash(req_hash):
	api_lists = {'wininet.dll': api_list_wininet, 
				'kernel32.dll' : api_list_kernel32, 
				'advapi32.dll' : api_list_advapi32, 
				'sqlite3.dll' : api_list_sqlite3}
	for dllname, api_list in api_lists.iteritems():
		for apiname in api_list:
			ahash = calc_hash(apiname)
			if ahash == req_hash:
				return dllname + '.' + apiname
	return None
	
def create_enum(enum_name, hash_api_map):
	data_type_manager = currentProgram.getDataTypeManager()
	enum = data_type_manager.getDataType("/" + enum_name)
	if not enum: 
		enum = EnumDataType(enum_name, 4) # 4 byte enum
		print("created enum " + enum_name)
		for hashval, decoded_api in hash_api_map.iteritems():
			enum.add(decoded_api, hashval)
			print("added enum value " + decoded_api + " " + str(hex(hashval)))
		enum = data_type_manager.addDataType(enum, None)
	else:
		print("enum already exists")

def first_operand_is_register(inst, register_name):
	first_op = inst.getOpObjects(0)[0]
	return first_op.toString() == register_name
	
def second_operand_is_register(inst, register_name):
	first_op = inst.getOpObjects(1)[0]
	return first_op.toString() == register_name

def apply_equates(inst_api_map):
	for inst, api in inst_api_map.iteritems():
		hashvalue = inst.getOpObjects(1)[0].getValue()
		opIndex = 1
		address = inst.getAddress()
		equate_name = api
		# delete the equate before applying it
		ClearEquateCmd(equate_name, address, opIndex).applyTo(currentProgram)
		SetEquateCmd(equate_name, address, opIndex, hashvalue).applyTo(currentProgram)
		
def search_and_set_api_label(it, decoded_api):
	max_steps = 15
	steps = 0
	while it.hasNext and steps < max_steps:
		steps += 1
		inst = getInstructionAt(it.next())
		if inst == None: continue
		if inst.getMnemonicString() == "MOV" and second_operand_is_register(inst, "EAX"):
			first_op = inst.getOpObjects(0)[0]
			new_name = decoded_api.split(".")[-1]
			print('setting new name ' + new_name)
			getSymbolAt(first_op).setName(new_name, SourceType.USER_DEFINED)
			break
		
def main():
	address_view = currentProgram.getMemory().getExecuteSet()
	it = address_view.getAddresses(True)
	inst_api_map = {} # maps instruction to api name--used for equate
	hash_api_map = {} # maps hash value to api name--used for enum
		
	while it.hasNext():
		address = it.next()
		inst = getInstructionAt(address)
		if inst is None: continue
		
		# check mnemonic
		if inst.getMnemonicString() != "MOV": continue
		
		# check first operand
		if not first_operand_is_register(inst, "ECX"): continue

		# obtain second operand and collect instructions that contain api hashes
		second_op = inst.getOpObjects(1)[0]	
		if isinstance(second_op, Scalar):
			value = second_op.getValue()
			decoded_api = find_api_for_hash(value)	
			if decoded_api:
				print('found api ', decoded_api)
				inst_api_map[inst] = decoded_api
				hash_api_map[value] = decoded_api
				inst.setComment(CodeUnit.EOL_COMMENT, decoded_api)
				# now also set a label with decoded api some instructions further
				search_and_set_api_label(it, decoded_api)

		
	# create the enum type if not exists
	create_enum("LummaAPIHash", hash_api_map)

	# apply the equates for the hashes
	apply_equates(inst_api_map)
	print('done')
	
main()